>q：MySQL 表行数超过 2000w 左右，一般会被认为是大表，需要做拆分，这个数值是怎么来的呢？

a: B+ 树结构高度会增加，这将导致查询所需磁盘 I/O 次数增多。例如，在根节点被内存缓存的情况下，3 层 B+ 树查一条记录需 2 次 I/O，4 层则需 3 次。由于磁盘 I/O 速度慢，过多操作会形成性能瓶颈，使查询变慢，影响整体效率。在实际应用中，由于 1-3 层 B+ 树能兼顾存储容量与查询性能，因此是较为合理的高度。了解了 B + 树索引后，我们以 Bigint 类型的主键索引为例，来估算一下 3 层高的 B+ 树索引能存多少数据。

* 先看根节点，InnoDB 存储引擎的最小存储单元是页，一页为 16KB，在 B+ 树索引里，Bigint 占 8 字节，指针占 6 字节，那根节点能存的数据元素大概就是 16KB 除以 14B，也就是 1170 个。
* 接着算第二层，这一层每个节点存储的也是键值和指针，所以每个节点也能存 1170 个元素，那第二层总共能存的元素个数就是 1170 乘 1170，也就是 137 万个。
* 最后看第三层，如果每行数据占 1KB 空间，那第三层每个节点能存 16KB 除以 1KB，即 16 个元素。这样算下来，第三层总共能存的数据个数大概是 1170 乘 1170 乘 16，结果在 2100 万左右。

估算还需结合压测